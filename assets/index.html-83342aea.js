import{_ as d,P as c,Q as i,$ as t,a1 as e,a0 as a,a3 as n,C as l}from"./framework-62102715.js";const p={},r=n('<h1 id="一体机简介" tabindex="-1"><a class="header-anchor" href="#一体机简介" aria-hidden="true">#</a> 一体机简介</h1><h3 id="一体机系统概述" tabindex="-1"><a class="header-anchor" href="#一体机系统概述" aria-hidden="true">#</a> 一体机系统概述</h3><ul><li><p>集群管理平台: xcat</p></li><li><p>集群调度系统: slurm</p></li><li><p>集群帐号管理: nis</p></li><li><p>集群监控系统: ganglia</p></li></ul><h3 id="一体机详细规划" tabindex="-1"><a class="header-anchor" href="#一体机详细规划" aria-hidden="true">#</a> 一体机详细规划</h3><table><thead><tr><th>主机名</th><th>ipmi ip</th><th>1口系统网IP</th><th>高速网 IB IP</th></tr></thead><tbody><tr><td>mgt</td><td>172.16.9.200/23</td><td>172.16.8.200/23</td><td>172.16.7.200/24</td></tr><tr><td>n01</td><td>172.16.9.1/23</td><td>172.16.8.1/23</td><td>172.16.7.1/24</td></tr><tr><td>n02</td><td>172.16.9.2/23</td><td>172.16.8.2/23</td><td>172.16.7.2/24</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>n11</td><td>172.16.9.11/23</td><td>172.16.8.11/23</td><td>172.16.7.11/24</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td></tr></tbody></table>',5),u={class:"hint-container tip"},h={class:"hint-container-title"},m=t("ul",null,[t("li",null,"以详细规划表为准"),t("li",null,[a("见系统 "),t("code",null,"/etc/hosts"),a(" 文件")])],-1),g=n(`<h3 id="管理员常用批命令" tabindex="-1"><a class="header-anchor" href="#管理员常用批命令" aria-hidden="true">#</a> 管理员常用批命令</h3><h3 id="批命令-从管理节点往计算节点发命令" tabindex="-1"><a class="header-anchor" href="#批命令-从管理节点往计算节点发命令" aria-hidden="true">#</a> 批命令, 从管理节点往计算节点发命令</h3><ul><li>查看系统版本</li></ul><div class="language-bash" data-ext="sh"><pre class="language-bash"><code><span class="token function">cat</span> /etc/redhat-release

psh all <span class="token string">&quot;cat /etc/redhat-release&quot;</span>
</code></pre></div><ul><li>查看网络是否连通</li></ul><div class="language-bash" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mgt ~<span class="token punctuation">]</span><span class="token comment"># pping all</span>
n01: <span class="token function">ping</span>
n02: <span class="token function">ping</span>
<span class="token punctuation">..</span>.
</code></pre></div><ul><li>查时间</li></ul><div class="language-bash" data-ext="sh"><pre class="language-bash"><code> <span class="token punctuation">[</span>root@mgt ~<span class="token punctuation">]</span><span class="token comment"># psh all date</span>
 n01: Sat Jun  <span class="token number">6</span> <span class="token number">22</span>:41:28 CST <span class="token number">2020</span>
 n02: Sat Jun  <span class="token number">6</span> <span class="token number">22</span>:41:28 CST <span class="token number">2020</span>
</code></pre></div><ul><li>批拷贝, 把管理节点的 <code>/etc/hosts</code> 拷贝到计算节点的 <code>/etc</code></li></ul><div class="language-bash" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mgt ~<span class="token punctuation">]</span><span class="token comment"># pscp /etc/hosts all:/etc</span>
n01: <span class="token keyword">done</span>
n02: <span class="token keyword">done</span>
</code></pre></div><ul><li>批关机, 给 n01, n02 节点发关机命令</li></ul><div class="language-bash" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mgt ~<span class="token punctuation">]</span><span class="token comment"># psh n[01-02] &quot;shutdown -h now&quot;</span>
</code></pre></div><ul><li>远程开关机</li></ul><div class="language-bash" data-ext="sh"><pre class="language-bash"><code> rpower all <span class="token function">stat</span>       <span class="token comment"># 查看状态</span>
 rpower all on         <span class="token comment"># 远程开机</span>
 rpower all off        <span class="token comment"># 远程关机</span>
</code></pre></div>`,14),x={class:"hint-container warning"},_={class:"hint-container-title"},k=t("ul",null,[t("li",null,"远程关机属于硬关机, 只有在系统无法登录，死机等情况才采用这种方式关机")],-1),b=n(`<h3 id="检查共享目录挂载情况" tabindex="-1"><a class="header-anchor" href="#检查共享目录挂载情况" aria-hidden="true">#</a> 检查共享目录挂载情况</h3><div class="language-bash" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mgt ~<span class="token punctuation">]</span><span class="token comment"># psh all &quot;df -h | grep share&quot;</span>
n01: mgt-ib:/share                29G  <span class="token number">9</span>.7G   20G  <span class="token number">34</span>% /share

</code></pre></div><p>如果没有挂载,只需要在节点上运行:</p><div class="language-text" data-ext="text"><pre class="language-text"><code> mount /share
</code></pre></div><h3 id="服务器-ipmi-管理" tabindex="-1"><a class="header-anchor" href="#服务器-ipmi-管理" aria-hidden="true">#</a> 服务器 ipmi 管理</h3>`,5),v=t("li",null,[t("p",null,[a("下载安装 "),t("code",null,"MobaXterm"),a(" 软件, 登录 mgt 节点, 直接运行 firefox 启动浏览器")])],-1),f=t("p",null,"输入节点的 ipmi 的 ip 地址, 用户名, 密码, 即可访问节点的 ipmi",-1),N={href:"https://ipmi-ip",target:"_blank",rel:"noopener noreferrer"},y=t("li",null,"帐号: ......",-1),q=t("li",null,"密码: ......",-1),w={class:"hint-container tip"},I={class:"hint-container-title"},S=t("ul",null,[t("li",null,"常用于节点故障, 登录 ipmi 管理界面查看硬件日志"),t("li",null,"常用于节点无法登录, 网络不通, 登录 ipmi 管理界面, 启动 ikvm 进行操作")],-1),B=n(`<h3 id="调度系统-slurm-管理" tabindex="-1"><a class="header-anchor" href="#调度系统-slurm-管理" aria-hidden="true">#</a> 调度系统 slurm 管理</h3><ul><li>重启某个节点服务</li></ul><div class="language-text" data-ext="text"><pre class="language-text"><code>systemctl restart slurmd
</code></pre></div><ul><li><p>重启整个 slurm 调度系统</p><ul><li>管理节点:</li></ul><div class="language-text" data-ext="text"><pre class="language-text"><code>systemctl restart slurmctld.service
</code></pre></div><ul><li>计算节点:</li></ul><div class="language-text" data-ext="text"><pre class="language-text"><code>psh all &quot;systemctl restart slurmd&quot;
</code></pre></div></li><li><p>修改配置队列</p><div class="language-text" data-ext="text"><pre class="language-text"><code>[root@mgt ~]# vim /etc/slurm/slurm.conf

NodeName=n[01-15] CPUs=52 State=UNKNOWN
PartitionName=compute Nodes=n[01-15] Default=YES  MaxTime=INFINITE State=UP
</code></pre></div><p>修改完后, 同步 slurm 配置:</p><div class="language-text" data-ext="text"><pre class="language-text"><code>pscp /etc/slurm/slurm.conf all:/etc/slurm/
</code></pre></div></li></ul>`,4);function P(C,E){const s=l("Badge"),o=l("ExternalLinkIcon");return c(),i("div",null,[r,t("div",u,[t("p",h,[e(s,{type:"tip",text:"提示 tip"})]),m]),g,t("div",x,[t("p",_,[e(s,{type:"tip",text:"提示"})]),k]),b,t("ul",null,[v,t("li",null,[f,t("ul",null,[t("li",null,[t("a",N,[a("https://ipmi-ip"),e(o)])]),y,q])])]),t("div",w,[t("p",I,[e(s,{type:"tip",text:"提示"})]),S]),B])}const V=d(p,[["render",P],["__file","index.html.vue"]]);export{V as default};
